import{c}from"./notificiation.DyHDLNjw.js";import{B as d}from"./endpoints.QH1VciTq.js";import{k as l}from"./index.B9b1t7QR.js";import{a as m}from"./index.CViUNx8d.js";const p=`${d}/api/invoice`;let f=[];const s=m(f),u=async n=>{try{const e=await l.post(p,{json:n,credentials:"include"}).json();s.set(s.get().concat(e)),c({title:"Factura creada!",type:"success"})}catch(e){if(e.name==="HTTPError"&&e.response.status>=400){const t=await e.response.json();c({title:"Ups! Hubo un error",description:t.error,type:"error"})}else c({title:"Factura creada!",description:"La factura se creó con éxito, pero la conexión se perdió. Recarga la página para verlo.",type:"success"}),console.log("Error de conexión inesperado, pero la factura se creó con éxito:",e)}};document.addEventListener("DOMContentLoaded",()=>{document.querySelectorAll(".add-to-cart-btn").forEach(t=>{t.addEventListener("click",()=>{const r=t.closest(".product-card");if(r){const o=r.querySelector(".invoice-form");o&&o.classList.toggle("hidden")}})}),document.querySelectorAll(".invoice-form form").forEach(t=>{t&&t.addEventListener("submit",async r=>{r.preventDefault();const o=new FormData(r.target),i={client_name:o.get("client_name"),client_phone_number:o.get("client_phone_number"),status:"pendiente"};try{await u(i);const a=r.target.closest(".invoice-form");a&&(a.classList.add("hidden"),r.target.reset())}catch(a){console.error("Error al enviar la factura:",a)}})})});
