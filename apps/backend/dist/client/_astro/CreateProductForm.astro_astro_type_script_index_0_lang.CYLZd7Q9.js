import{P as N}from"./products.module.oR8XwO8S.js";import{B as q}from"./endpoints.QH1VciTq.js";import"./notificiation.DyHDLNjw.js";import"./index.B9b1t7QR.js";import"./index.CViUNx8d.js";const o=document.querySelector("#product-name"),c=document.querySelector("#product-description"),l=document.querySelector("#product-price"),d=document.querySelector("#quantity"),u=document.querySelector("#min-stock"),m=document.querySelector("#product-image"),p=document.querySelector("#manufacturer"),S=document.querySelector("#product-form"),b=document.querySelector("#submit-btn"),n=document.querySelector("#status-message");let v=!1,f=!1,g=!1,x=!1,y=!1,L=!1,h=!1;const t=(e,E)=>{const i=e.parentElement.nextElementSibling,a=e.nextElementSibling;e.value===""?(e.classList.remove("input-invalid","input-valid"),i?.classList.add("hidden"),a.innerHTML="",a.classList.add("hidden")):E?(e.classList.add("input-valid"),e.classList.remove("input-invalid"),i?.classList.add("hidden"),a.innerHTML='<span class="iconify" data-icon="mdi:check-circle" style="color: green;"></span>',a.classList.remove("hidden")):(e.classList.add("input-invalid"),e.classList.remove("input-valid"),i?.classList.remove("hidden"),a.innerHTML='<span class="iconify" data-icon="mdi:close-circle" style="color: red;"></span>',a.classList.remove("hidden"))},r=()=>{v&&f&&g&&x&&y&&L&&h?b.disabled=!1:b.disabled=!0};o.addEventListener("input",()=>{v=o.value.trim().length>0,t(o,v),r()});c.addEventListener("input",()=>{f=c.value.trim().length>0,t(c,f),r()});l.addEventListener("input",()=>{const e=parseFloat(l.value);g=!isNaN(e)&&e>0,t(l,g),r()});d.addEventListener("input",()=>{const e=parseInt(d.value);x=!isNaN(e)&&e>=0,t(d,x),r()});u.addEventListener("input",()=>{const e=parseInt(u.value);y=!isNaN(e)&&e>=0,t(u,y),r()});m.addEventListener("change",()=>{L=m.files.length>0,t(m,L),r()});p.addEventListener("input",()=>{h=p.value.trim().length>0,t(p,h),r()});S.addEventListener("submit",async e=>{if(e.preventDefault(),!v||!f||!g||!x||!y||!L||!h){t(o,v),t(c,f),t(l,g),t(d,x),t(u,y),t(p,h),t(m,L);return}n.textContent="Subiendo imagen...",n.className="mt-4 text-center text-sm font-medium text-indigo-600";let E="";const i=m.files[0];if(i){const a=new FormData;a.append("product-image",i);try{const s=await fetch(`${q}/api/products/images/upload`,{method:"POST",body:a});if(!s.ok)throw new Error("Error al subir la imagen.");E=(await s.json()).imageUrl,n.textContent="Imagen subida. Guardando producto...",n.className="mt-4 text-center text-sm font-medium text-green-600"}catch(s){n.textContent=`Error al subir imagen: ${s.message}`,n.className="mt-4 text-center text-sm font-medium text-red-600",console.error("Error al subir la imagen:",s);return}}try{await N.addProduct({name:o.value.trim(),description:c.value.trim(),image:E,manufacturer:p.value.trim(),quantity:parseInt(d.value),minimum_stock:parseInt(u.value),price:parseFloat(l.value)}),n.textContent="Producto guardado con Ã©xito.",n.className="mt-4 text-center text-sm font-medium text-green-600"}catch(a){n.textContent=`Error al guardar producto: ${a.message}`,n.className="mt-4 text-center text-sm font-medium text-red-600",console.error("Error al guardar el producto:",a)}S.reset(),r()});
